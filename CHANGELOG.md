Add test case for W [wxxggK] line 2.1
Refactor codebase with Z [BMTJLz] line 6.1
